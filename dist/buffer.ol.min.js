!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports='<div class="m-buffer">\n  <button id="point" data-geometry-type="Point" class="g-cartografia-gps3" title="Pintar punto"></button>\n  <button id="lineString" data-geometry-type="LineString" class="g-cartografia-lineas" title="Pintar linea"></button>\n  <button id="polygon" data-geometry-type="Polygon" class="g-cartografia-poligono" title="Pintar poligono"></button>\n  <button id="eliminar" class="g-cartografia-papelera" title="Eliminar"></button>\n  <input type="number" id="metersbuffer" value="50"></input>\n</div>'},function(e){e.exports={url:{name:"buffer",separator:"*"},constructor:"M.plugin.Buffer",parameters:[{type:"object",properties:[{type:"enum",name:"position",possibleValues:["TL","TR","BL","BR"],position:0}]}],files:{ol:{scripts:"buffer.ol.min.js",styles:"buffer.ol.min.css"}},metadata:{name:"Buffer",description:"Dibuja un buffer o área de influencia",text:"Dibuja un buffer o área de influencia sobre una linea, polígono o punto que se dibuje sobre el mapa.",version:"1.0.0",date:"Diciembre, 2019",author:"",org:"Consejería de Medioambiente y Ordenación del Territorio de la Junta de Andalucía",tags:"mapea,plugin",icon:"./facade/assets/icons/icons.svg"}}},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(2);var r=n(0),o=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,c(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,M.impl.Control),n=t,(r=[{key:"addTo",value:function(e,n){var r=this;e.getMapImpl().getInteractions().forEach(function(e){e instanceof ol.interaction.DoubleClickZoom&&(r.dblClickInteraction_=e)}),l(c(t.prototype),"addTo",this).call(this,e,n)}},{key:"activateClick",value:function(e){this.dblClickInteraction_.setActive(!1),e.getMapImpl().on("dblclick",function(t){var n=new CustomEvent("mapclicked",{detail:t.coordinate,bubbles:!0});e.getContainer().dispatchEvent(n)})}},{key:"deactivateClick",value:function(e){this.dblClickInteraction_.setActive(!0),e.getMapImpl().removeEventListener("dblclick")}}])&&a(n.prototype,r),o&&a(n,o),t}();function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(e,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=new s;return(r=b(this,d(t).call(this,o,"buffer"))).editLayer=e,r.featuresEdit=n,M.utils.isUndefined(s)&&M.exception("La implementación usada no puede crear controles influenceareaControl"),r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,M.Control),n=t,(r=[{key:"createView",value:function(e){var t=this;return this.facadeMap_=e,new Promise(function(e,n){var r=M.template.compileSync(o.a);t.template_=r,t.template_.querySelector("#point").addEventListener("click",function(e){return t.manageDraw_(e)}),t.template_.querySelector("#polygon").addEventListener("click",function(e){return t.manageDraw_(e)}),t.template_.querySelector("#lineString").addEventListener("click",function(e){return t.manageDraw_(e)}),t.template_.querySelector("#eliminar").addEventListener("click",function(e){return t.removeFeatures_(e)}),e(r)})}},{key:"manageDraw_",value:function(e){var t=this,n=!1,r=e.target.getAttribute("data-geometry-type");if(n=this.manageActivatedDeactivated(e.target),this.manageInteraction_(!1,null,null),!n){var o=new ol.interaction.Draw({features:this.featuresEdit,type:r});o.on("drawend",function(n){t.manageInteraction_(!1,null,null);var r=document.querySelector("input#metersbuffer");if(r){var o=r.value;t.addBuffer_(n.feature,o,e.target)}}),this.facadeMap_.getMapImpl().addInteraction(o)}n=!1}},{key:"manageInteraction_",value:function(e,t,n){var r=this,o=window.event;if(e){var i=new ol.interaction.Draw({features:this.featuresEdit,type:n});i.on("drawend",function(e){[].concat(r.facadeMap_.getMapImpl().getInteractions().getArray()).forEach(function(e){e instanceof ol.interaction.Draw&&r.facadeMap_.getMapImpl().removeInteraction(e)});var t=document.querySelector("input#metersbuffer");if(t){var n=t.value;r.addBuffer_(e.feature,n,o.target)}}),this.facadeMap_.getMapImpl().addInteraction(i)}else{[].concat(this.facadeMap_.getMapImpl().getInteractions().getArray()).forEach(function(e){e instanceof ol.interaction.Draw&&r.facadeMap_.getMapImpl().removeInteraction(e)})}}},{key:"addBuffer_",value:function(e,t,n){var r=new jsts.io.OL3Parser,o=r.read(e.getGeometry()).buffer(parseInt(t,10));e.setGeometry(r.write(o)),this.manageActivatedDeactivated(n)}},{key:"manageActivatedDeactivated",value:function(e){var t=!1,n=document.querySelectorAll("div.m-influencearea button.activated");if(n&&null!=n&&n.length&&n.length>0)for(var r=0;r<n.length;r+=1){n[0].classList.remove("activated"),t=!0}return t}},{key:"removeFeatures_",value:function(){this.editLayer.getSource().clear();var e=document.querySelectorAll("div.m-influencearea button.activated");if(e&&null!=e&&e.length)for(var t=0;t<e.length;t+=1){e[0].classList.remove("activated")}this.manageInteraction_(!1,null,null)}},{key:"equals",value:function(e){return e instanceof t}}])&&y(n.prototype,r),i&&y(n,i),t}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_(this,w(t).call(this))).layerOL=e,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,M.impl.Layer),n=t,(r=[{key:"addTo",value:function(e){this.map=e,this.map.getMapImpl().addLayer(this.layerOL)}},{key:"destroy",value:function(){var e=this.map.getMapImpl();M.utils.isNullOrEmpty(this.layerOL)||(e.removeLayer(this.layerOL),this.layerOL=null),this.map=null}}])&&g(n.prototype,r),o&&g(n,o),t}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new S(e);return n=k(this,L(t).call(this,{},r)),M.utils.isUndefined(S)&&M.exception("La implementación usada no puede crear capas BufferLayer"),n.layer=e,n.type=M.layer.type.GeoJSON,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,M.Layer),n=t,(r=[{key:"equals",value:function(e){var n=!1;return e instanceof t&&(n=this.name===e.name),n}}])&&P(n.prototype,r),o&&P(n,o),t}(),C=n(1);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=x(this,B(t).call(this))).map_=null,e.controls_=[],e.position_=n.position||"TR",e.className_=n.classname||"m-buffer",e.collapsible_=n.collapsible||!0,e.metadata_=C.metadata,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(t,M.Plugin),n=t,(r=[{key:"addTo",value:function(e){this.map_=e,this.featuresEdit=new ol.Collection,this.featureOverlay=new ol.layer.Vector({source:new ol.source.Vector({name:"bufferLayer",features:this.featuresEdit}),style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 0, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})}),this.featureOverlay.setMap(this.map_.getMapImpl());var t=this.hasLayerBuffer_();null==t?(this.bufferLayer=new I(this.featureOverlay),this.map_.addLayers(this.bufferLayer)):this.bufferLayer=t,this.control_=new v(this.featureOverlay,this.featuresEdit),this.panelTools_=new M.ui.Panel("buffer",{collapsible:this.collapsible_,className:this.className_,collapsedButtonClass:"g-cartografia-editar",position:M.ui.position[this.position_],tooltip:"Área de influencia"}),this.panelTools_.addControls(this.control_),this.map_.addPanels(this.panelTools_)}},{key:"destroy",value:function(){this.map_.removeControls(this.control_),this.bufferLayer.getImpl().getOL3Layer()&&this.bufferLayer.getImpl().getOL3Layer().getSource().clear(!0),this.map_=null,this.control_=null,this.panelTools_=null,this.featuresEdit=null,this.featureOverlay=null}},{key:"getControls",value:function(){var e=[];return e.push(this.control_),e}},{key:"hasLayerBuffer_",value:function(){for(var e=this.map_.getLayers(),t=0;t<e.length;t+=1){var n=e[t];if(n instanceof I)return n}return null}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"name",get:function(){return"buffer"}},{key:"control",get:function(){return this.control_}}])&&D(n.prototype,r),o&&D(n,o),t}();window.M.plugin||(window.M.plugin={}),window.M.layer||(window.M.layer={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Buffer=A,window.M.layer.BufferLayer=I,window.M.impl.control.BufferControl=s}]);
//# sourceMappingURL=buffer.ol.min.js.map